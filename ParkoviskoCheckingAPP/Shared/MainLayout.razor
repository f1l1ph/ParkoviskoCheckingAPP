@inherits LayoutComponentBase
@using ParkoviskoCheckingAPP.Shared;

<div class="page">
    
    @if(authentificated == false)
    {
        <div class="login-container">
            @if (haveInternet)
            {
                <p>I have internet</p>
            }
            else
            {
                <p>error, no internet</p>
            }

            @if(authentificated == false && triedLogin == true)
            {
                <p> <em>wrong username or password, sorry</em></p>
            }

            <h1>Login</h1>

            <div class="form-group">
                <label for="username">Username:</label>
                <input id="username" @bind="username" class="form-control" />
            </div>

            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" @bind="password" class="form-control" />
            </div>

            <button class="btn btn-primary" @onclick="Login">Login</button>
        </div>
    }

    @if (authentificated == true)
    {
        <div class="sidebar">
            <NavMenu/>
        </div>

        <main>
            <div class="top-row px-4">
            <a href="https://docs.microsoft.com/aspnet/" target="_blank">About</a>
        </div>

        <article class="content px-4">
            @Body
        </article>
    </main>
    }
</div>

@using ParkoviskoCheckingAPP.services;
@inject AuthentificationService service
@using ParkoviskoCheckingAPP.Data
@using System.Runtime.InteropServices

@code{
    NetworkAccess accessType = Connectivity.Current.NetworkAccess;
    bool haveInternet = false;

    private string username;
    private string password;

    bool authentificated = false;
    bool triedLogin = false;

    private async Task Login()
    {
        LoginModel model = new LoginModel { UserName = username, Email = "", Password = password };
        authentificated = await service.Login(model);
        triedLogin = true;
    }

    protected override void OnInitialized()
    {
        if (accessType == NetworkAccess.Internet)
        {
            haveInternet = true;
        }
    }
}

<style>
    .login-container {
        max-width: 400px;
        margin: 20px auto;
        padding: 20px;
        border: 2px solid #555;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        background-color: #333;
        color:#fff;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 95vh; /* Set height to 100% of the viewport height */
        width: 100vh;
    }

    .form-group {
        margin-bottom: 15px;
        width: 100%; /* Ensure the form groups take up the full width */
    }

    label {
        display: block;
        margin-bottom: 5px;
    }

    .form-control {
        width: 100%;
        padding: 8px;
        box-sizing: border-box;
        border: 1px solid #555;
        background-color:#444;
        color:#fff;
        border-radius: 3px;
    }

    .btn {
        display: inline-block;
        padding: 8px 16px;
        font-size: 14px;
        font-weight: bold;
        text-align: center;
        text-decoration: none;
        cursor: pointer;
        border: 1px solid #3498db;
        border-radius: 3px;
        color: #fff;
        background-color: #3498db;
    }

    .btn:hover {
        background-color: #2980b9;
        border-color: #2980b9;
    }
</style>

@if (DeviceInfo.Current.Idiom == DeviceIdiom.Phone)
{
    <style>
        .login-container {
        max-width: 100%; /* Full width for smaller screens */
        max-height:110%;
        height:100vh;
        margin:0;
        }

        .form-control {
        width: calc(100% - 16px); /* Adjust input width for smaller screens */
        }
    </style>
}